---
type: flow
id: workflows
workMode: document
status: done
phase: done
priority: P0
domain: process
version: "9.1"
---

# Flow: Workflows <!-- id: flow_workflows -->

> æ ‡å‡†å·¥ä½œæµï¼Œå®šä¹‰äººæœºåä½œçš„è¾“å…¥å¤„ç†å’Œæµç¨‹è·¯ç”±

**æ‰§è¡Œè§„èŒƒ**ï¼š`.solodevflow/flows/workflows.md`
> **é‡è¦**ï¼šAI ä¿®æ”¹æ‰§è¡Œè§„èŒƒæ—¶ï¼Œå¿…é¡»ä¿®æ”¹ `template/flows/workflows.md`ï¼ˆæ¨¡æ¿æºï¼‰ï¼Œè€Œé `.solodevflow/flows/`ï¼ˆé¡¹ç›®å®ä¾‹ï¼‰ã€‚é¡¹ç›®å®ä¾‹é€šè¿‡ `solodevflow upgrade .` ä»æ¨¡æ¿åŒæ­¥ã€‚

---

## 1. Overview <!-- id: flow_overview -->

### 1.1 Purpose

å®šä¹‰äººæœºåä½œçš„ä¸»å·¥ä½œæµæ¡†æ¶ï¼š

| èŒè´£ | è¯´æ˜ |
|------|------|
| **æ„å›¾è·¯ç”±** | è¯†åˆ«ç”¨æˆ·è¾“å…¥ç±»å‹ï¼Œè·¯ç”±åˆ°å¯¹åº”å­æµç¨‹ |
| **PRD å±‚ç®¡ç†** | ç®¡ç† PRD ç”Ÿå‘½å‘¨æœŸï¼ˆdraft â†’ decomposing â†’ doneï¼‰ |
| **Work Item å±‚ç®¡ç†** | ç®¡ç†å•ä¸ªåŠŸèƒ½ç”Ÿå‘½å‘¨æœŸï¼ˆpending â†’ doneï¼‰ |
| **ä¸Šä¸‹æ–‡ç®¡ç†** | è·¨å¯¹è¯ä¿æŒçŠ¶æ€ |

**è®¾è®¡åŸåˆ™**ï¼š
- **æŒ‰éœ€åŠ è½½**ï¼šä¸»æµç¨‹ç²¾ç®€ï¼Œå­æµç¨‹æŒ‰éœ€åŠ è½½
- **å•ä¸€èŒè´£**ï¼šæ¯ä¸ªå­æµç¨‹ç‹¬ç«‹ç®¡ç†

### 1.2 Core Participants

| è§’è‰² | èŒè´£ |
|------|------|
| User | æä¾›è¾“å…¥ï¼ˆå’¨è¯¢/éœ€æ±‚/æ··åˆï¼‰ |
| AI | åˆ†æè¾“å…¥ã€è·¯ç”±æµç¨‹ã€æ‰§è¡Œäº¤ä»˜ |
| state.json | å”¯ä¸€çŠ¶æ€æºï¼Œä¿æŒè·¨å¯¹è¯ä¸Šä¸‹æ–‡ |

---

## 2. Flow Diagram <!-- id: flow_diagram -->

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Session Start                            â”‚
â”‚  è¯»å– state.json / index.json â†’ æ±‡æŠ¥çŠ¶æ€ â†’ ç­‰å¾…ç”¨æˆ·æŒ‡ç¤º      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Input Analysis                             â”‚
â”‚                                                              â”‚
â”‚  ç”¨æˆ·è¾“å…¥ â†’ æ„å›¾è¯†åˆ« â†’ è·¯ç”±åˆ°å­æµç¨‹                          â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â†“        â†“        â†“        â†“        â†“        â†“        â†“   â”‚
â”‚ ç›´æ¥    äº§å“    éœ€æ±‚    è®¾è®¡    å®ç°    éªŒæ”¶    æ— å…³     â”‚
â”‚ æ‰§è¡Œ    å’¨è¯¢    æµç¨‹    æµç¨‹    æµç¨‹    æµç¨‹    æ‹’ç»     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Input Analysis <!-- id: flow_input_analysis -->

> æ¯æ¬¡æ¥æ”¶ç”¨æˆ·è¾“å…¥ï¼Œé¦–å…ˆè¿›è¡Œæ„å›¾è¯†åˆ«å’Œè·¯ç”±

### 3.1 Input Types

| ç±»å‹ | è¯†åˆ«ä¿¡å· | è·¯ç”±ç›®æ ‡ |
|------|----------|----------|
| **ç›´æ¥æ‰§è¡Œ** | ç®€å•æ˜ç¡®ã€å•æ­¥æ“ä½œ | ç«‹å³æ‰§è¡Œï¼Œä¸èµ°æµç¨‹ |
| **äº§å“å’¨è¯¢** | è¯¢é—®åŠŸèƒ½ã€è¿›åº¦ã€å®ç° | Â§4 Consulting Flow |
| **Bug ä¿®å¤** | æŠ¥å‘Šé—®é¢˜ã€ä¿®å¤è¯·æ±‚ | Â§5 Bug Fix Flow |
| **éœ€æ±‚å¤„ç†** | æ–°åŠŸèƒ½ã€å˜æ›´ã€è§„èŒƒä¿®æ”¹ | [flow-requirements.md](flow-requirements.md) |
| **è®¾è®¡å¤„ç†** | è¿›å…¥è®¾è®¡é˜¶æ®µ | [flow-design.md](flow-design.md) |
| **å®ç°å¤„ç†** | è¿›å…¥å®ç°é˜¶æ®µ | [flow-implementation.md](flow-implementation.md) |
| **æµ‹è¯•å¤„ç†** | è¿›å…¥æµ‹è¯•é˜¶æ®µ | [flow-testing.md](flow-testing.md) |
| **å®¡æ ¸æ‰¹å‡†** | æ‰¹å‡†/é€šè¿‡ï¼ˆreview é˜¶æ®µï¼‰ | Â§6 Review Approval |
| **æ— å…³æƒ³æ³•** | ä¸æœ¬äº§å“å®Œå…¨æ— å…³ | ç›´æ¥æ‹’ç» |

### 3.2 Direct Execution Criteria

ç›´æ¥æ‰§è¡Œç±»å‹çš„åˆ¤æ–­æ ‡å‡†ï¼š

| æ¡ä»¶ | è¯´æ˜ |
|------|------|
| âœ… èŒƒå›´æ˜ç¡® | å•æ­¥æ“ä½œå¯å®Œæˆ |
| âœ… ä¸æ¶‰åŠè®¾è®¡å˜æ›´ | æ— éœ€æ›´æ–°æ–‡æ¡£ |
| âœ… å¯ç›´æ¥å®šä½ | é—®é¢˜æ˜ç¡®ï¼ˆå¦‚"ä¿®å¤ç¬¬42è¡Œç©ºæŒ‡é’ˆ"ï¼‰ |

**è¾¹ç•Œåœºæ™¯**ï¼š
- "ä¿®å¤ç™»å½•é—®é¢˜" â†’ âŒ ä¸æ˜¯ç›´æ¥æ‰§è¡Œï¼ˆé—®é¢˜ä¸æ˜ç¡®ï¼‰
- "ä¿®å¤ login.js ç¬¬42è¡Œç©ºæŒ‡é’ˆ" â†’ âœ… ç›´æ¥æ‰§è¡Œ

### 3.3 Phase-Based Routing

æ ¹æ®å½“å‰ Work Item çš„ phase è‡ªåŠ¨è·¯ç”±ï¼š

| å½“å‰ Phase | é»˜è®¤è·¯ç”± |
|------------|----------|
| `feature_requirements` | flow-requirements.md æˆ– Â§13 Flow Type Handling |
| `feature_review` | Â§5 Review Approval |
| `feature_design` | flow-design.md |
| `feature_implementation` | flow-implementation.md |
| `feature_testing` | flow-testing.md |

### 3.4 Work Item Type Routing

æ ¹æ® Work Item ç±»å‹ï¼ˆtype å­—æ®µï¼‰æ‰§è¡Œä¸åŒæµç¨‹ï¼š

| Type | workMode=document | workMode=code |
|------|-------------------|---------------|
| **feature** | æ ‡å‡†æµç¨‹ | æ ‡å‡†æµç¨‹ |
| **capability** | æ ‡å‡†æµç¨‹ | æ ‡å‡†æµç¨‹ |
| **flow** | æ ‡å‡†æµç¨‹ | **ç‰¹æ®Šæµç¨‹** â†’ Â§13 Flow Type Handling |

**Flow ç‰¹æ®Šæ€§**ï¼š
- Flow æ˜¯è·¨æ¨¡å—åä½œæµç¨‹ï¼Œä¾èµ–å¤šä¸ª Feature/Capability
- `workMode=code` æ—¶ï¼Œéœ€å…ˆå®Œæˆ Module Impact Specifications
- æ¯ä¸ªä¾èµ–æ¨¡å—çš„ä¿®æ”¹ç‚¹å¿…é¡»æ˜ç¡®å®šä¹‰å¹¶å•ç‹¬å®¡æ‰¹

---

## 4. Consulting Flow <!-- id: flow_consulting -->

> å’¨è¯¢äº¤ä»˜æµç¨‹ï¼šå›ç­”äº§å“å’¨è¯¢

### 4.1 Flow Steps

```
[ç”¨æˆ·å’¨è¯¢]
    â†“
[åŠ è½½ PRD + ç›¸å…³æ–‡æ¡£]
    â†“
[ç”Ÿæˆå›ç­”]
    â†“
[æ£€æŸ¥æ˜¯å¦åŒ…å«éœ€æ±‚æˆåˆ†]
    â”œâ”€ æ˜¯ â†’ è¯¢é—®æ˜¯å¦å¤„ç†éœ€æ±‚
    â””â”€ å¦ â†’ ç­‰å¾…ä¸‹ä¸€è¾“å…¥
```

### 4.2 Mixed Input Handling

æ··åˆè¾“å…¥ï¼ˆå’¨è¯¢+éœ€æ±‚ï¼‰å¤„ç†ï¼š
1. **å…ˆå›ç­”å’¨è¯¢**
2. **å†è¯¢é—®**ï¼š"åˆšæ‰æåˆ° xxxï¼Œæ˜¯å¦ç°åœ¨å¤„ç†è¿™ä¸ªéœ€æ±‚ï¼Ÿ"
3. **ç”¨æˆ·é€‰æ‹©** â†’ è¿›å…¥éœ€æ±‚æµç¨‹æˆ–ç»§ç»­ç­‰å¾…

### 4.3 Document Query Mechanism

é€šè¿‡ index.json å®šä½ç›¸å…³æ–‡æ¡£ï¼š

| åŒ¹é…æ–¹å¼ | è¯´æ˜ |
|----------|------|
| ç²¾ç¡®åŒ¹é… | id æˆ– title å®Œå…¨åŒ¹é… |
| æ¨¡ç³ŠåŒ¹é… | å…³é”®è¯å‡ºç°åœ¨ title ä¸­ |
| æ— åŒ¹é… | è¿”å› PRD ä½œä¸ºå…œåº• |

---

## 5. Bug Fix Flow <!-- id: flow_bugfix -->

> Bug ä¿®å¤æµç¨‹ï¼šä»£ç ä¼˜å…ˆï¼Œåè¡¥æ–‡æ¡£

### 5.1 Bug Source Classification

| æ¥æº | ç‰¹å¾ | å¤„ç†ä¼˜å…ˆçº§ |
|------|------|------------|
| **å¼€å‘ä¸­å‘ç°** | åœ¨ implementation/testing é˜¶æ®µå‘ç° | ç«‹å³å¤„ç†ï¼Œä¸åˆ‡æ¢ Work Item |
| **å·²å®ŒæˆåŠŸèƒ½** | status=done çš„ Work Item å‡ºç°é—®é¢˜ | ä¿®å¤ä»£ç  â†’ è¡¥å……æ–‡æ¡£ |
| **ç”¨æˆ·æŠ¥å‘Š** | å¤–éƒ¨ç”¨æˆ·åé¦ˆçš„é—®é¢˜ | åˆ›å»ºæ–° Work Item æˆ–å…³è”ç°æœ‰ |

### 5.2 Bug Fix Decision Flow

```
[æŠ¥å‘Š/å‘ç° Bug]
    â†“
[é—®é¢˜å®šä½]
    â”œâ”€ èƒ½ç›´æ¥å®šä½ï¼ˆæ–‡ä»¶+è¡Œå·æ˜ç¡®ï¼‰â†’ ç›´æ¥ä¿®å¤ï¼ˆÂ§5.3ï¼‰
    â””â”€ ä¸èƒ½ç›´æ¥å®šä½ï¼ˆé—®é¢˜æ¨¡ç³Šï¼‰
            â†“
        [åˆ†æé—®é¢˜ï¼Œæ˜ç¡®èŒƒå›´]
            â†“
        [åˆ¤æ–­å½±å“èŒƒå›´]
            â”œâ”€ å•æ–‡ä»¶/å±€éƒ¨ â†’ ç›´æ¥ä¿®å¤ï¼ˆÂ§5.3ï¼‰
            â””â”€ è·¨æ¨¡å—/ç³»ç»Ÿæ€§ â†’ éœ€æ±‚å˜æ›´æµç¨‹
```

### 5.3 Code-First Fix Flow

> æ ¸å¿ƒåŸåˆ™ï¼šå…ˆä¿®å¤ä»£ç ï¼Œå†è¡¥å……æ–‡æ¡£

```
Step 1: é—®é¢˜å¤ç°
    â””â”€ æ˜ç¡®è§¦å‘æ¡ä»¶å’Œé”™è¯¯ç°è±¡

Step 2: å®šä½é—®é¢˜ä»£ç 
    â””â”€ ç¡®å®šå‡ºé”™çš„æ–‡ä»¶å’Œå‡½æ•°

Step 3: ä¿®å¤ä»£ç 
    â””â”€ ç¼–å†™ä¿®å¤ä»£ç  + éªŒè¯æµ‹è¯•

Step 4: æ–‡æ¡£åŒæ­¥ï¼ˆÂ§5.4ï¼‰
    â””â”€ åˆ†ææ˜¯å¦éœ€è¦æ›´æ–°è®¾è®¡/éœ€æ±‚æ–‡æ¡£
```

### 5.4 Post-Fix Documentation Sync

> ä»£ç ä¿®å¤åï¼Œåˆ†ææ˜¯å¦éœ€è¦åŒæ­¥æ–‡æ¡£

**å†³ç­–æµç¨‹**ï¼š

```
[ä»£ç ä¿®å¤å®Œæˆ]
    â†“
[åˆ†æï¼šæ˜¯å¦éœ€è¦æ›´æ–°è®¾è®¡æ–‡æ¡£ï¼Ÿ]
    â”œâ”€ æ˜¯ï¼ˆæ¥å£å˜æ›´ã€æ¶æ„è°ƒæ•´ï¼‰â†’ ç›´æ¥æ›´æ–°è®¾è®¡æ–‡æ¡£
    â””â”€ å¦ â†’ ç»§ç»­
    â†“
[åˆ†æï¼šæ˜¯å¦éœ€è¦æ›´æ–°éœ€æ±‚æ–‡æ¡£ï¼Ÿ]
    â”œâ”€ æ˜¯ï¼ˆåŠŸèƒ½å˜æ›´ã€æ–°å¢çº¦æŸï¼‰â†’ èµ°éœ€æ±‚å˜æ›´æµç¨‹
    â””â”€ å¦ â†’ å®Œæˆ
```

**æ–‡æ¡£æ›´æ–°æ ‡å‡†**ï¼š

| æ–‡æ¡£ç±»å‹ | éœ€è¦æ›´æ–°çš„æƒ…å†µ | å¤„ç†æ–¹å¼ |
|----------|----------------|----------|
| **è®¾è®¡æ–‡æ¡£** | æ¥å£å®šä¹‰å˜æ›´ã€æ•°æ®ç»“æ„è°ƒæ•´ã€æ¶æ„ä¿®æ”¹ | ç›´æ¥æ›´æ–° |
| **éœ€æ±‚æ–‡æ¡£** | åŠŸèƒ½è¡Œä¸ºå˜æ›´ã€æ–°å¢ä¸šåŠ¡è§„åˆ™ã€åˆ é™¤åŠŸèƒ½ | éœ€æ±‚å˜æ›´æµç¨‹ |

### 5.5 Quick Fix Criteria

ä»¥ä¸‹æƒ…å†µå¯**ç›´æ¥ä¿®å¤**ï¼Œæ— éœ€æ–‡æ¡£åŒæ­¥ï¼š

| æ¡ä»¶ | ç¤ºä¾‹ |
|------|------|
| âœ… çº¯å®ç°é—®é¢˜ | è¾¹ç•Œæ¡ä»¶ã€ç©ºæŒ‡é’ˆã€ç±»å‹é”™è¯¯ |
| âœ… ä¸å½±å“æ¥å£ | å†…éƒ¨å®ç°ä¿®æ­£ï¼ŒAPI ä¸å˜ |
| âœ… ä¸å½±å“è¡Œä¸º | æ€§èƒ½ä¼˜åŒ–ã€ä»£ç é‡æ„ |
| âœ… å¼€å‘ä¸­å‘ç° | Work Item ä»åœ¨ implementation é˜¶æ®µ |

### 5.6 Bug Fix Examples

| Bug ä¿®å¤ | è®¾è®¡æ–‡æ¡£ | éœ€æ±‚æ–‡æ¡£ |
|----------|----------|----------|
| ä¿®å¤ç©ºæŒ‡é’ˆå¼‚å¸¸ | ä¸éœ€è¦ | ä¸éœ€è¦ |
| ä¿®å¤ API è¿”å›æ ¼å¼ | éœ€è¦ï¼ˆæ¥å£å®šä¹‰ï¼‰ | ä¸éœ€è¦ |
| æ·»åŠ éç©ºéªŒè¯ | ä¸éœ€è¦ | éœ€è¦ï¼ˆæ–°å¢çº¦æŸï¼‰ |
| ä¿®å¤è¾¹ç•Œæ¡ä»¶ | ä¸éœ€è¦ | ä¸éœ€è¦ |

### 5.7 Phase Guards Behavior

å½“ä¿®æ”¹ `status=done` çš„ Work Item ä»£ç æ—¶ï¼š

- PreToolUse Hook å¼¹å‡º `ask` ç¡®è®¤ï¼ˆéå¼ºåˆ¶é˜»æ­¢ï¼‰
- æé†’æ£€æŸ¥æ–‡æ¡£åŒæ­¥éœ€æ±‚
- ç”¨æˆ·ç¡®è®¤åå…è®¸ä¿®æ”¹

---

## 6. Review Approval Flow <!-- id: flow_review -->

> å®¡æ ¸å®¡æ‰¹æµç¨‹ï¼šäººç±»å®¡æ ¸æ–‡æ¡£ï¼Œæ‰¹å‡†åè¿›å…¥ä¸‹ä¸€é˜¶æ®µ

### 6.1 Core Principles

| åŸåˆ™ | è¯´æ˜ |
|------|------|
| **æ–‡æ¡£æ˜¯ Truth** | éœ€æ±‚æ–‡æ¡£æ˜¯åç»­é˜¶æ®µçš„å”¯ä¸€ä¾æ® |
| **äººç±»å®¡æ ¸å¿…éœ€** | AI ç”Ÿæˆçš„æ–‡æ¡£å¿…é¡»ç»äººç±»å®¡æ ¸ |
| **æ˜¾å¼æ‰¹å‡†** | å¿…é¡»è¯´"æ‰¹å‡†"/"é€šè¿‡"æ‰èƒ½è¿›å…¥ä¸‹ä¸€é˜¶æ®µ |

### 6.2 Review Flow

```
[AI å®Œæˆæ–‡æ¡£]
    â†“
[phase â†’ feature_review]
    â†“
[æç¤ºç”¨æˆ·å®¡æ ¸]
    â†“
[ç­‰å¾…åé¦ˆ]
    â”œâ”€ æ‰¹å‡† â†’ phase â†’ ä¸‹ä¸€é˜¶æ®µ
    â”œâ”€ ä¿®æ”¹ â†’ AI ä¿®æ”¹åé‡æ–°å®¡æ ¸
    â””â”€ æ‹’ç» â†’ è¿”å›ä¸Šä¸€é˜¶æ®µ
```

### 6.3 Approval Syntax

| ç±»å‹ | å…³é”®è¯ |
|------|--------|
| **æ‰¹å‡†** | "æ‰¹å‡†"ã€"é€šè¿‡"ã€"åŒæ„"ã€"approve" |
| **ä¿®æ”¹** | "ä¿®æ”¹ xxx"ã€"è¡¥å…… xxx" |
| **æ‹’ç»** | "é‡æ–°æ¥"ã€"éœ€æ±‚ä¸å¯¹" |

### 6.4 Review Assistanceï¼ˆå¯é€‰ï¼‰

> äººç±»å¯ä¸»åŠ¨è°ƒç”¨è¾…åŠ©å·¥å…·è¿›è¡Œæ·±åº¦å®¡æ ¸

| è¾…åŠ©å·¥å…· | ç”¨é€” | è§¦å‘æ–¹å¼ |
|----------|------|----------|
| **review-assistant** | AI è¾…åŠ©å®¡æ ¸éœ€æ±‚æ–‡æ¡£ | äººç±»ä¸»åŠ¨è°ƒç”¨ï¼ˆéè‡ªåŠ¨è§¦å‘ï¼‰ |

**é€‚ç”¨åœºæ™¯**ï¼š
- å¤æ‚éœ€æ±‚æ–‡æ¡£çš„æ·±åº¦å®¡æ ¸
- éœ€è¦è¡Œä¸šæœ€ä½³å®è·µå‚è€ƒ
- å¸Œæœ›ç”Ÿæˆç»“æ„åŒ–å®¡æ ¸æŠ¥å‘Š

**è¾“å‡º**ï¼š`.solodevflow/reviews/{doc-id}-review.md`

è¯¦è§ [fea-review-assistant.md](../features/fea-review-assistant.md)

---

## 7. Subflow References <!-- id: flow_subflows -->

> å­æµç¨‹ç‹¬ç«‹æ–‡æ¡£ï¼ŒæŒ‰éœ€åŠ è½½

| å­æµç¨‹ | éœ€æ±‚æ–‡æ¡£ | æ‰§è¡Œè§„èŒƒ | è§¦å‘æ¡ä»¶ |
|--------|----------|----------|----------|
| **éœ€æ±‚æµç¨‹** | [flow-requirements.md](flow-requirements.md) | requirements.md | `feature_requirements` é˜¶æ®µ |
| **è®¾è®¡æµç¨‹** | [flow-design.md](flow-design.md) | design.md | `feature_design` é˜¶æ®µ |
| **å®ç°æµç¨‹** | [flow-implementation.md](flow-implementation.md) | implementation.md | `feature_implementation` é˜¶æ®µ |
| **æµ‹è¯•æµç¨‹** | [flow-testing.md](flow-testing.md) | testing.md | `feature_testing` é˜¶æ®µ |
| **Bug ä¿®å¤æµç¨‹** | Â§5 Bug Fix Flowï¼ˆæœ¬æ–‡æ¡£ï¼‰ | bugfix.md | æŠ¥å‘Š/å‘ç° Bug |
| **é‡æ„æµç¨‹** | [flow-refactoring.md](flow-refactoring.md) | refactoring.md | `refactoring.enabled = true` |

**åŠ è½½ç­–ç•¥**ï¼š
- ä¸»æµç¨‹ï¼ˆworkflows.mdï¼‰ï¼šæ¯æ¬¡ Session åŠ è½½
- å­æµç¨‹æ‰§è¡Œè§„èŒƒï¼šè¿›å…¥å¯¹åº”é˜¶æ®µæˆ–è§¦å‘æ¡ä»¶æ—¶æŒ‰éœ€åŠ è½½
- éœ€æ±‚æ–‡æ¡£ï¼šä½œä¸º AI ç†è§£æµç¨‹çš„å‚è€ƒä¾æ®

---

## 8. Context Management <!-- id: flow_context -->

### 8.1 State Persistence

| çŠ¶æ€ | å­˜å‚¨ä½ç½® | è¯´æ˜ |
|------|----------|------|
| activeFeatures | state.json | å½“å‰æ´»è·ƒçš„ Feature åˆ—è¡¨ |
| subtasks | state.json | è¿›è¡Œä¸­çš„ä»»åŠ¡åˆ—è¡¨ |
| phase | æ–‡æ¡£ frontmatter | Feature çš„å½“å‰é˜¶æ®µ |

### 8.2 Session Start

æ¯æ¬¡å¯¹è¯å¼€å§‹ï¼š
1. è¯»å– `state.json`
2. **æ£€æŸ¥é‡æ„æ¨¡å¼**ï¼šå¦‚æœ `project.refactoring.enabled = true`ï¼Œåˆ‡æ¢åˆ° `refactoring.md` æ‰§è¡Œè§„èŒƒ
3. æ­£å¸¸æ¨¡å¼ä¸‹ç»§ç»­ï¼š
   - æ˜¾ç¤ºæ´»è·ƒ Feature å’Œ phase
   - æ˜¾ç¤ºè¿›è¡Œä¸­çš„ subtasks
   - ç­‰å¾…ç”¨æˆ·æŒ‡ç¤º

**é‡æ„æ¨¡å¼è‡ªåŠ¨åˆ‡æ¢**ï¼š
- é‡æ„æ¨¡å¼é€šè¿‡ `state.json` çš„ `project.refactoring.enabled` æ ‡å¿—æ§åˆ¶
- AI åœ¨ Session Start æ£€æµ‹æ­¤æ ‡å¿—ï¼Œè‡ªåŠ¨åŠ è½½å¯¹åº”çš„æ‰§è¡Œè§„èŒƒ
- é‡æ„å®Œæˆåï¼ˆ`enabled = false`ï¼‰ï¼Œè‡ªåŠ¨å›åˆ°æ­£å¸¸å·¥ä½œæµ

---

## 9. Two-Layer Lifecycle <!-- id: flow_two_layer -->

> å·¥ä½œæµç®¡ç†ä¸¤ä¸ªç‹¬ç«‹ä½†ç›¸äº’å…³è”çš„ç”Ÿå‘½å‘¨æœŸï¼šPRD å±‚å’Œ Work Item å±‚

### 9.1 Layer Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          PRD Layer                                       â”‚
â”‚                                                                          â”‚
â”‚   prd_draft â†’ prd_scope_review â†’ prd_decomposing â”€â”€â”€â”€â”€â”€â†’ prd_done       â”‚
â”‚                                       â”‚                      â†‘           â”‚
â”‚                                       â”‚ (å¯å›æº¯ä¿®æ”¹ PRD)      â”‚           â”‚
â”‚                                       â†“                      â”‚           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚              Work Item Layer (æ¯ä¸ªç‹¬ç«‹è¿è¡Œ)                 â”‚         â”‚
â”‚   â”‚                                                            â”‚         â”‚
â”‚   â”‚   Feature 1: pending â†’ requirements â†’ review â†’ design â†’...â”‚         â”‚
â”‚   â”‚   Feature 2: pending â†’ requirements â†’ review â†’ design â†’...â”‚         â”‚
â”‚   â”‚   Capability 1: ...                                        â”‚         â”‚
â”‚   â”‚   Flow 1: ...                                              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚   â”‚                                                            â”‚
â”‚   â”‚   â€» æ‰€æœ‰ Work Items éœ€æ±‚é˜¶æ®µå®Œæˆ â†’ PRD å¯å…³é—­              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| å±‚çº§ | èŒè´£ | çŠ¶æ€å­˜å‚¨ |
|------|------|----------|
| **PRD Layer** | äº§å“ scope ç®¡ç†ã€éœ€æ±‚åˆ†è§£åè°ƒ | `state.json â†’ prd.phase` |
| **Work Item Layer** | å•ä¸ªåŠŸèƒ½çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸ | æ–‡æ¡£ frontmatter `phase` |

### 9.2 Layer Interaction

| äº¤äº’åœºæ™¯ | è¯´æ˜ |
|----------|------|
| **å‘ä¸‹åˆ†è§£** | PRD scope æ‰¹å‡†åï¼Œè‡ªåŠ¨è¿›å…¥åˆ†è§£é˜¶æ®µï¼Œé€ä¸ªè°ƒç ” Work Items |
| **å‘ä¸Šå›æº¯** | è°ƒç ” Work Item æ—¶å‘ç°éœ€è¦ä¿®æ”¹ PRDï¼ˆæ–°å¢ Domainã€è°ƒæ•´ scopeï¼‰ |
| **æ±‡èšå…³é—­** | æ‰€æœ‰ Work Items éœ€æ±‚é˜¶æ®µå®Œæˆåï¼ŒPRD æ‰èƒ½å…³é—­ |

---

## 10. PRD Lifecycle <!-- id: flow_prd_lifecycle -->

> PRD ä½œä¸ºé¡¶å±‚æ–‡æ¡£ï¼Œæœ‰ç‹¬ç«‹äº Work Item çš„ç”Ÿå‘½å‘¨æœŸ

### 10.1 PRD Phase Sequence

```
prd_draft â†’ prd_scope_review â†’ prd_decomposing â†’ prd_done
```

| Phase | è¯´æ˜ | ä¸‹ä¸€æ­¥ |
|-------|------|--------|
| `prd_draft` | PRD åˆç¨¿ç¼–å†™ä¸­ | å®Œæˆå â†’ `prd_scope_review` |
| `prd_scope_review` | High-level scope å®¡æ ¸ | æ‰¹å‡†å â†’ `prd_decomposing` |
| `prd_decomposing` | éœ€æ±‚åˆ†è§£é˜¶æ®µï¼Œé€ä¸ªè°ƒç ” Feature/Capability/Flow | å…¨éƒ¨å®Œæˆ â†’ `prd_done` |
| `prd_done` | PRD å…³é—­ï¼Œæ‰€æœ‰ Work Items å¯ç‹¬ç«‹è¿›å…¥åç»­é˜¶æ®µ | - |

### 10.2 PRD Scope Review

> è¿™æ˜¯ PRD å±‚çš„å®¡æ ¸ï¼Œä¸åŒäº Work Item çš„ feature_review

**å®¡æ ¸å†…å®¹**ï¼š
- äº§å“æ„¿æ™¯æ˜¯å¦æ¸…æ™°
- Domain åˆ’åˆ†æ˜¯å¦åˆç†
- Feature Roadmap æ˜¯å¦å®Œæ•´è¦†ç›–éœ€æ±‚
- ä¼˜å…ˆçº§æ’åºæ˜¯å¦æ­£ç¡®

**æ‰¹å‡†å**ï¼š
- PRD phase è¿›å…¥ `prd_decomposing`
- **è·¯ç”±åˆ° [flow-requirements.md](flow-requirements.md) Â§5 PRD Decomposing Flow**

### 10.3 Decomposing Phase Routing

> åˆ†è§£é˜¶æ®µçš„æ‰§è¡Œç»†èŠ‚å®šä¹‰åœ¨éœ€æ±‚å­æµç¨‹ä¸­

**è·¯ç”±è§„åˆ™**ï¼š
- å½“ `prd.phase = prd_decomposing` æ—¶
- åŠ è½½ [flow-requirements.md](flow-requirements.md) Â§5 PRD Decomposing Flow
- æŒ‰è¯¥å­æµç¨‹æ‰§è¡Œéœ€æ±‚åˆ†è§£

**å­æµç¨‹èŒè´£**ï¼š
- è¯»å– Feature Roadmapï¼ŒæŒ‰ä¼˜å…ˆçº§å¤„ç†
- è°ƒç”¨ Flow A/B è¿›è¡Œéœ€æ±‚è°ƒç ”
- PRD å›æº¯ä¿®æ”¹è§„åˆ™
- Work Item éœ€æ±‚å®Œæˆåˆ¤å®š

### 10.4 PRD Close Criteria

> PRD å…³é—­æ¡ä»¶ï¼šæ‰€æœ‰ Work Items éœ€æ±‚é˜¶æ®µå®Œæˆ

**æ£€æŸ¥æ¸…å•**ï¼š
- [ ] Feature Roadmap ä¸­æ‰€æœ‰ Work Items çš„ phase â‰¥ `feature_design`ï¼ˆå³é€šè¿‡äº† requirements å’Œ reviewï¼‰
- [ ] æ²¡æœ‰é—æ¼çš„ Work Itemsï¼ˆæ‰€æœ‰å‘ç°çš„åŠŸèƒ½éƒ½å·²è®°å½•ï¼‰
- [ ] äººç±»æ˜¾å¼ç¡®è®¤ PRD å®Œæ•´æ€§

**å…³é—­å‘½ä»¤**ï¼š
```bash
node scripts/state.js set-prd-phase prd_done
```

### 10.5 PRD State Fields

> å­˜å‚¨åœ¨ `state.json` ä¸­

```json
{
  "prd": {
    "phase": "prd_decomposing",
    "scopeApprovedAt": "2025-01-01T00:00:00Z",
    "decomposingStartedAt": "2025-01-01T00:00:00Z",
    "totalWorkItems": 12,
    "completedRequirements": 5
  }
}
```

| å­—æ®µ | è¯´æ˜ |
|------|------|
| `phase` | PRD å½“å‰é˜¶æ®µ |
| `scopeApprovedAt` | Scope å®¡æ ¸é€šè¿‡æ—¶é—´ |
| `decomposingStartedAt` | è¿›å…¥åˆ†è§£é˜¶æ®µçš„æ—¶é—´ |
| `totalWorkItems` | Feature Roadmap ä¸­çš„ Work Item æ€»æ•° |
| `completedRequirements` | å·²å®Œæˆéœ€æ±‚é˜¶æ®µçš„ Work Item æ•°é‡ |

---

## 11. Work Item Phase Lifecycle <!-- id: flow_phase -->

> å•ä¸ª Work Itemï¼ˆFeature/Capability/Flowï¼‰çš„ç”Ÿå‘½å‘¨æœŸ

### 11.1 Phase Sequence

```
pending â†’ feature_requirements â†’ feature_review â†’ feature_design â†’ feature_implementation â†’ feature_testing â†’ done
```

**é˜¶æ®µèŒè´£**ï¼š

| é˜¶æ®µ | ä¸»è¦èŒè´£ |
|------|----------|
| `feature_requirements` | ç¼–å†™éœ€æ±‚æ–‡æ¡£ |
| `feature_review` | äººç±»å®¡æ ¸æ–‡æ¡£ |
| `feature_design` | ç¼–å†™è®¾è®¡æ–‡æ¡£ |
| `feature_implementation` | ç¼–å†™ä»£ç  + å•å…ƒæµ‹è¯• + é›†æˆæµ‹è¯• |
| `feature_testing` | ç³»ç»Ÿçº§æµ‹è¯•ï¼ˆE2E/æ€§èƒ½/å®‰å…¨/å›å½’ï¼‰ |

### 11.2 Phase Transitions

| è½¬æ¢ | è§¦å‘æ¡ä»¶ | å‘½ä»¤ |
|------|----------|------|
| â†’ requirements | å¼€å§‹å¤„ç†éœ€æ±‚ | `set-phase <id> feature_requirements` |
| â†’ review | AI å®Œæˆæ–‡æ¡£ | `set-phase <id> feature_review` |
| â†’ design | äººç±»æ‰¹å‡†éœ€æ±‚ | `set-phase <id> feature_design` |
| â†’ implementation | è®¾è®¡å®Œæˆ | `set-phase <id> feature_implementation` |
| â†’ testing | å®ç°å®Œæˆ | `set-phase <id> feature_testing` |
| â†’ done | æµ‹è¯•é€šè¿‡ | `set-phase <id> done` |

### 11.3 Phase Guards

| Phase | é˜»æ­¢çš„æ“ä½œ |
|-------|------------|
| `feature_requirements` | Write/Edit `src/**/*`, `tests/**/*` |
| `feature_review` | Write/Edit `docs/designs/**/*`, `src/**/*` |
| `feature_design` | Write/Edit `src/**/*`, `tests/**/*` |

---

## 12. Hooks Integration <!-- id: flow_hooks -->

> Hooks å®ç°å·¥ä½œæµè‡ªåŠ¨åŒ–ï¼Œè¯¦è§ [fea-hooks-integration.md](../features/fea-hooks-integration.md)

| Hook | èŒè´£ |
|------|------|
| **SessionStart** | æ³¨å…¥äº§å“çŠ¶æ€ |
| **UserPromptSubmit** | æ³¨å…¥ä¸Šä¸‹æ–‡ã€æ£€æµ‹éœ€æ±‚å˜æ›´ |
| **PreToolUse** | é˜¶æ®µå®ˆå«ã€æ–‡ä»¶ä¿æŠ¤ |
| **PostToolUse** | æ–‡æ¡£éªŒè¯ï¼ˆå¯é€‰ï¼‰ |

---

## 13. Execution Principles <!-- id: flow_principles -->

### å§‹ç»ˆåš

- æ¯æ¬¡è¾“å…¥ â†’ å…ˆåˆ†æè¾“å…¥ç±»å‹
- ç›´æ¥æ‰§è¡Œ â†’ ç«‹å³æ‰§è¡Œï¼Œä¸èµ°æµç¨‹
- è¿›å…¥å­æµç¨‹ â†’ åŠ è½½å¯¹åº”å­æµç¨‹æ–‡æ¡£
- çŠ¶æ€æ›´æ–° â†’ é€šè¿‡ State CLI
- æ–‡æ¡£å˜æ›´ â†’ è¿è¡Œ index.js

### ç»ä¸åš

- è·³è¿‡è¾“å…¥åˆ†æç›´æ¥æ‰§è¡Œ
- å°†å¤æ‚é—®é¢˜é”™åˆ¤ä¸º"ç›´æ¥æ‰§è¡Œ"
- è·³è¿‡ review é˜¶æ®µ
- æœªç»äººç±»æ‰¹å‡†æ›´æ–° phase
- ç›´æ¥ç¼–è¾‘ state.json

---

## 14. Dependencies <!-- id: flow_dependencies -->

| Dependency | Type | è¯´æ˜ |
|------------|------|------|
| state-management | hard | çŠ¶æ€å­˜å‚¨å’Œè¯»å– |
| hooks-integration | soft | å·¥ä½œæµè‡ªåŠ¨åŒ– |
| document-validation | soft | æ–‡æ¡£éªŒè¯ |

---

## 15. Acceptance Criteria <!-- id: flow_acceptance -->

| Item | Verification | Pass Criteria |
|------|--------------|---------------|
| æ„å›¾è¯†åˆ« | æµ‹è¯•å„ç±»è¾“å…¥ | æ­£ç¡®è·¯ç”±åˆ°å¯¹åº”æµç¨‹ |
| Bug ä¿®å¤è·¯ç”± | æŠ¥å‘Š bug | è¿›å…¥ Â§5 Bug Fix Flow |
| æ ¹å› åˆ†æ | done çŠ¶æ€ä¿®å¤ | æ­£ç¡®åˆ¤æ–­æ ¹å› ç±»å‹å¹¶é€‰æ‹©ä¿®å¤è·¯å¾„ |
| é˜¶æ®µè·¯ç”± | åˆ‡æ¢ phase | è‡ªåŠ¨åŠ è½½å¯¹åº”å­æµç¨‹ |
| å®¡æ ¸æµç¨‹ | æäº¤æ–‡æ¡£å | è¿›å…¥ review é˜¶æ®µ |
| æ‰¹å‡†è¯­æ³• | è¯´"æ‰¹å‡†" | phase æ­£ç¡®è½¬æ¢ |
| æŒ‰éœ€åŠ è½½ | è¿›å…¥å­æµç¨‹ | åªåŠ è½½å¯¹åº”æ–‡æ¡£ |
| Flow ç±»å‹è¯†åˆ« | type=flow + workMode=code | è¿›å…¥ Â§16 ç‰¹æ®Šæµç¨‹ |
| PRD å±‚ç”Ÿå‘½å‘¨æœŸ | PRD å®Œæˆå | æ­£ç¡®è¿›å…¥ prd_decomposing è€Œéç›´æ¥è®¾è®¡é˜¶æ®µ |
| ä¸¤å±‚çŠ¶æ€æœº | PRD å’Œ Work Item | ç‹¬ç«‹ç®¡ç†ï¼Œæ­£ç¡®äº¤äº’ |

---

## 16. Flow Type Handling (workMode=code) <!-- id: flow_type_handling -->

> Flow ç±»å‹ workMode=code æ—¶çš„ç‰¹æ®Šå¤„ç†æµç¨‹

### 16.1 Why Flow is Different

| ç»´åº¦ | Feature | Flow (workMode=code) |
|------|---------|----------------------|
| **è¾¹ç•Œ** | è‡ªåŒ…å«ï¼Œç‹¬ç«‹äº¤ä»˜ | è·¨æ¨¡å—ï¼Œåè°ƒå¤šæ–¹ |
| **ä¾èµ–å½±å“** | ä¸»è¦æ¶ˆè´¹ä¾èµ– | ä¸»åŠ¨ä¿®æ”¹ä¾èµ–æ¨¡å— |
| **éœ€æ±‚ç²’åº¦** | å•ä¸€åŠŸèƒ½éœ€æ±‚ | åˆ†è§£ä¸ºå¤šä¸ªæ¨¡å—éœ€æ±‚ |
| **å®¡æ‰¹èŒƒå›´** | å•ä¸€æ–‡æ¡£å®¡æ‰¹ | å¤šä¸ªæ¨¡å—å½±å“éœ€åˆ†åˆ«å®¡æ‰¹ |

### 16.2 Flow Workflow Stages

```
[REQUIREMENTS] â†’ [REVIEW] â†’ [MODULE IMPACT] â†’ [DESIGN] â†’ [IMPLEMENTATION] â†’ [TESTING] â†’ [DONE]
                              â†‘
                         Flow ä¸“å±é˜¶æ®µ
```

**MODULE IMPACT é˜¶æ®µ**ï¼ˆFlow ä¸“å±ï¼‰ï¼š
1. åŸºäº Flow éœ€æ±‚æ–‡æ¡£ï¼Œåˆ†ææ¯ä¸ªä¾èµ–æ¨¡å—
2. ä¸ºæ¯ä¸ªæ¨¡å—ç¼–å†™ Module Impact Specification
3. æ¯ä¸ª Module Impact å•ç‹¬å®¡æ‰¹
4. å…¨éƒ¨å®¡æ‰¹åæ‰èƒ½è¿›å…¥ DESIGN é˜¶æ®µ

### 16.3 Module Impact Specification Process

```
[Flow éœ€æ±‚é€šè¿‡å®¡æ‰¹]
    â†“
[è¯»å– dependencies åˆ—è¡¨]
    â†“
[ä¸ºæ¯ä¸ª dependency åˆ›å»ºå­ä»»åŠ¡]
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  For each dependency:                    â”‚
â”‚    1. åˆ†æè¯¥æ¨¡å—éœ€è¦çš„å˜æ›´               â”‚
â”‚    2. åœ¨ Flow æ–‡æ¡£ä¸­æ·»åŠ  Module Impact   â”‚
â”‚    3. åˆ›å»ºå­ä»»åŠ¡è¿½è¸ª                      â”‚
â”‚    4. äººç±»å®¡æ‰¹è¯¥æ¨¡å—çš„ Impact Spec       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
[æ‰€æœ‰ Module Impact å®¡æ‰¹é€šè¿‡]
    â†“
[è¿›å…¥ DESIGN é˜¶æ®µ]
```

### 16.4 å­ä»»åŠ¡å‘½åè§„èŒƒ

```bash
# åˆ›å»º Module Impact åˆ†æå­ä»»åŠ¡
node scripts/state.js add-subtask \
  --workitem=<flow-id> \
  --desc="[Module: <module-id>] ç¼–å†™ Module Impact Specification" \
  --source=impact-analysis

# ç¤ºä¾‹
node scripts/state.js add-subtask \
  --workitem=refactoring \
  --desc="[Module: state-management] æ·»åŠ  validateSubtask å‡½æ•°" \
  --source=impact-analysis
```

### 16.5 Phase Transition Rules (Flow)

| è½¬æ¢ | æ¡ä»¶ | è¯´æ˜ |
|------|------|------|
| requirements â†’ review | Flow éœ€æ±‚æ–‡æ¡£å®Œæˆ | æ ‡å‡†è½¬æ¢ |
| review â†’ design | **æ‰€æœ‰ Module Impact å®¡æ‰¹é€šè¿‡** | Flow ä¸“å±æ¡ä»¶ |
| design â†’ implementation | è®¾è®¡æ–‡æ¡£å®Œæˆ | æ ‡å‡†è½¬æ¢ |

### 16.6 Module Impact Specification Template

åœ¨ Flow æ–‡æ¡£ä¸­ï¼ŒSection 6 (æˆ–é€‚å½“ä½ç½®) æ·»åŠ ï¼š

```markdown
## Module Impact Specifications

### [Module: state-management]

**å˜æ›´æ¦‚è¿°**ï¼šæ·»åŠ å­ä»»åŠ¡çŠ¶æ€éªŒè¯åŠŸèƒ½

**æ¥å£å˜æ›´**ï¼š
| å˜æ›´ç±»å‹ | æè¿° |
|----------|------|
| æ–°å¢å‡½æ•° | `validateSubtaskTransition(from, to): boolean` |

**å®ç°è¦ç‚¹**ï¼š
1. çŠ¶æ€æœºå®šä¹‰ï¼špending â†’ in_progress â†’ completed/skipped
2. æ— æ•ˆè½¬æ¢æŠ›å‡º ValidationError

**éªŒæ”¶æ ‡å‡†**ï¼š
- [ ] æœ‰æ•ˆè½¬æ¢è¿”å› true
- [ ] æ— æ•ˆè½¬æ¢æŠ›å‡ºé”™è¯¯å¹¶åŒ…å«çŠ¶æ€ä¿¡æ¯

**å®¡æ‰¹çŠ¶æ€**ï¼šğŸ”² å¾…å®¡æ‰¹ / âœ… å·²å®¡æ‰¹
```

### 16.7 Execution Checklist

**è¿›å…¥ MODULE IMPACT é˜¶æ®µæ—¶**ï¼š
- [ ] ç¡®è®¤ Flow ç±»å‹ä¸” workMode=code
- [ ] è¯»å– Flow æ–‡æ¡£çš„ dependencies åˆ—è¡¨
- [ ] ä¸ºæ¯ä¸ª hard ä¾èµ–åˆ›å»º Module Impact å­ä»»åŠ¡
- [ ] æŒ‰ä¼˜å…ˆçº§ä¾æ¬¡å¤„ç†å„æ¨¡å—

**å®Œæˆ MODULE IMPACT é˜¶æ®µæ—¶**ï¼š
- [ ] æ‰€æœ‰ Module Impact Specification å·²ç¼–å†™
- [ ] æ‰€æœ‰ Module Impact å·²è·äººç±»å®¡æ‰¹ï¼ˆâœ…ï¼‰
- [ ] æ‰€æœ‰ç›¸å…³å­ä»»åŠ¡å·²å®Œæˆ
- [ ] å‡†å¤‡è¿›å…¥ DESIGN é˜¶æ®µ

---

*Version: v9.1*
*Created: 2024-12-20*
*Updated: 2025-12-30*
*Changes: v9.1 ç®€åŒ– Â§10 PRD Lifecycleï¼Œç§»é™¤æ‰§è¡Œç»†èŠ‚ï¼Œæ·»åŠ è·¯ç”±åˆ° flow-requirements.md Â§5ï¼›v9.0 æ–°å¢ Â§9 Two-Layer Lifecycle å’Œ Â§10 PRD Lifecycleï¼ˆä¸¤å±‚çŠ¶æ€æœºè®¾è®¡ï¼‰*
